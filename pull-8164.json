{"source": "https://github.com/QuantConnect/Lean", "title": "Feature 8159 code formatting with csharpier", "link": "https://github.com/QuantConnect/Lean/pull/8164", "state": "closed", "created_by": "femtotrader", "created_at": "2024-07-06T10:35:11Z", "updated_at": "2024-07-10T07:26:23Z", "closed_at": "2024-07-09T18:52:42Z", "body": "<!--- Provide a general summary of your changes in the Title above -->\r\n\r\n#### Description\r\n<!--- Describe your changes in detail -->\r\n\r\nAuto code formatting using CSharpier\r\n\r\n#### Related Issue\r\n<!--- This project only accepts pull requests related to open issues -->\r\n<!--- If suggesting a new feature or change, please discuss it in an issue first -->\r\n<!--- If fixing a bug, there should be an issue describing it with steps to reproduce -->\r\n<!--- Please link to the issue here: -->\r\n\r\nHelps #8159 but doesn't add pre-commit hook or CI\r\n\r\n#### Motivation and Context\r\n<!--- Why is this change required? What problem does it solve? -->\r\n\r\nCode formatting is a pain.\r\nAutomate this with csharpier\r\n\r\n#### Requires Documentation Change\r\n<!--- Please indicate if these changes will require updates to documentation, and if so, specify what changes are required -->\r\n\r\n#### How Has This Been Tested?\r\n<!--- Please describe in detail how you tested your changes. -->\r\n<!--- Include details of your testing environment, and the tests you ran to -->\r\n<!--- see how your change affects other areas of the code, etc. -->\r\n\r\n#### Types of changes\r\n<!--- What types of changes does your code introduce? Put an `x` in all the boxes that apply: -->\r\n- [ ] Bug fix (non-breaking change which fixes an issue)\r\n- [x] Refactor (non-breaking change which improves implementation)\r\n- [ ] Performance (non-breaking change which improves performance. Please add associated performance test and results)\r\n- [ ] New feature (non-breaking change which adds functionality)\r\n- [ ] Breaking change (fix or feature that would cause existing functionality to change)\r\n- [ ] Non-functional change (xml comments/documentation/etc)\r\n\r\n#### Checklist:\r\n<!--- The following is a checklist of items that MUST be completed before a PR is accepted -->\r\n<!--- If you're unsure about any of these, don't hesitate to ask. We're here to help! -->\r\n- [x] My code follows the code style of this project.\r\n- [X] I have read the **CONTRIBUTING** [document](https://github.com/QuantConnect/Lean/blob/master/CONTRIBUTING.md).\r\n- [X] I have added tests to cover my changes. <!--- If not applicable, please explain why -->\r\n- [ ] All new and existing tests passed.\r\n- [X] My branch follows the naming convention `bug-<issue#>-<description>` or `feature-<issue#>-<description>`\r\n\r\n<!--- Template inspired by https://www.talater.com/open-source-templates/#/page/99 -->\r\n", "comments": [{"user": "femtotrader", "is_staff": false, "created_at": "2024-07-06T10:38:05Z", "body": "Here is the process in Visual Studio 2022 : Tools / NuGet Package Manager / Package Manager Console\r\n\r\n```\r\nPM> dotnet new tool-manifest\r\nThe template \"Dotnet local tool manifest file\" was created successfully.\r\n\r\nPM> dotnet tool install csharpier\r\nYou can invoke the tool from this directory using the following commands: 'dotnet tool run dotnet-csharpier' or 'dotnet dotnet-csharpier'.\r\nTool 'csharpier' (version '0.28.2') was successfully installed. Entry is added to the manifest file C:\\Users\\Admin\\git\\github\\femto\\Lean\\.config\\dotnet-tools.json.\r\nPM> dotnet csharpier .\r\ndotnet : Error ./Algorithm.CSharp/OpeningBreakoutAlgorithm.cs - Failed syntax tree validation.\r\nAt line:1 char:1\r\n+ dotnet csharpier .\r\n+ ~~~~~~~~~~~~~~~~~~\r\n    + CategoryInfo          : NotSpecified: (Error ./Algorit...ree validation.:String) [], RemoteException\r\n    + FullyQualifiedErrorId : NativeCommandError\r\n \r\n  ----------------------------- Original: Around Line 329 -----------------------------\r\n              {\r\n                  // breakout to the downside, go short\r\n                  MarketTicket = MarketOrder(symbol, - -shares);\r\n                  Log(\"Enter short @ \" + MarketTicket.AverageFillPrice.SmartRounding());\r\n                  Plot(symbol, \"Enter\", MarketTicket.AverageFillPrice);\r\n  \r\n                  // we'll start with a global, non-trailing stop loss\r\n                  EnablePsarTrailingStop = false;\r\n  ----------------------------- Formatted: Around Line 364 -----------------------------\r\n              {\r\n                  // breakout to the downside, go short\r\n                  MarketTicket = MarketOrder(symbol, --shares);\r\n                  Log(\"Enter short @ \" + MarketTicket.AverageFillPrice.SmartRounding());\r\n                  Plot(symbol, \"Enter\", MarketTicket.AverageFillPrice);\r\n  \r\n                  // we'll start with a global, non-trailing stop loss\r\n                  EnablePsarTrailingStop = false;\r\nFormatted 3819 files in 7683ms\r\n```\r\n\r\nYou may noticed that `Algorithm.CSharp/OpeningBreakoutAlgorithm.cs` is problematic"}, {"user": "Martin-Molinero", "is_staff": true, "created_at": "2024-07-09T18:52:42Z", "body": "Hey @femtotrader! Interesting, thank you\r\nAs is, this change is not mergeable sorry, we should discuss & review the formatting rules to use in the related issue, when pinned/agreed, we can start applying them in chunks PRs and potentially adding a new CI to enforce them. Closing this PR will leave related issue open though  \ud83d\udcaf"}]}