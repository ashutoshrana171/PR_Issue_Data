{"source": "https://github.com/QuantConnect/Lean", "title": "Implements new indicator VWMA - Volume Weighted Moving Average", "link": "https://github.com/QuantConnect/Lean/pull/8161", "state": "closed", "created_by": "femtotrader", "created_at": "2024-07-06T06:45:33Z", "updated_at": "2024-07-20T08:25:52Z", "closed_at": "2024-07-16T14:14:39Z", "body": "<!--- Provide a general summary of your changes in the Title above -->\r\n\r\n#### Description\r\n<!--- Describe your changes in detail -->\r\n\r\nImplement new indicator - VWMA (Volume Weighted Moving Average)\r\n\r\n#### Related Issue\r\nCloses #8128\r\n\r\n#### Motivation and Context\r\nThe VWMA indicator wasn't implemented.\r\n(not to be  confused with VWAP)\r\n\r\n#### Requires Documentation Change\r\n<!--- Please indicate if these changes will require updates to documentation, and if so, specify what changes are required -->\r\nDoc for this indicator should be created but some docstring are written\r\n\r\n#### How Has This Been Tested?\r\n\r\ncomparison with talipp computation of VWMA(20) of SPY candle data using [generate_reference_data_from_talipp.py](https://github.com/QuantConnect/Lean/blob/master/Tests/TestData/generate_reference_data_from_talipp.py)\r\n\r\n#### Types of changes\r\n<!--- What types of changes does your code introduce? Put an `x` in all the boxes that apply: -->\r\n- [ ] Bug fix (non-breaking change which fixes an issue)\r\n- [ ] Refactor (non-breaking change which improves implementation)\r\n- [ ] Performance (non-breaking change which improves performance. Please add associated performance test and results)\r\n- [x] New feature (non-breaking change which adds functionality)\r\n- [ ] Breaking change (fix or feature that would cause existing functionality to change)\r\n- [ ] Non-functional change (xml comments/documentation/etc)\r\n\r\n#### Checklist:\r\n<!--- The following is a checklist of items that MUST be completed before a PR is accepted -->\r\n<!--- If you're unsure about any of these, don't hesitate to ask. We're here to help! -->\r\n- [x] My code follows the code style of this project.\r\n- [x] I have read the **CONTRIBUTING** [document](https://github.com/QuantConnect/Lean/blob/master/CONTRIBUTING.md).\r\n- [x] I have added tests to cover my changes. <!--- If not applicable, please explain why -->\r\n- [x] All new and existing tests passed.\r\n- [x] My branch follows the naming convention `bug-<issue#>-<description>` or `feature-<issue#>-<description>`\r\n\r\n<!--- Template inspired by https://www.talater.com/open-source-templates/#/page/99 -->\r\n", "comments": [{"user": "femtotrader", "is_staff": false, "created_at": "2024-07-06T07:06:39Z", "body": "The followings test is failing\r\n- `AcceptsRenkoBarsAsInput`\r\nbut others are passing.\r\n\r\nAny idea?"}, {"user": "AlexCatarino", "is_staff": true, "created_at": "2024-07-09T14:21:54Z", "body": "Since this is a moving average, we need to add it to the MovingAverageType enum after https://github.com/QuantConnect/Lean/pull/8177 is merged."}, {"user": "femtotrader", "is_staff": false, "created_at": "2024-07-09T19:14:24Z", "body": "Will need to also add\r\n\r\n    indicator = MovingAverageType.VWMA.AsIndicator(name, 9);\r\n    Assert.IsInstanceOf(typeof(VolumeWeightedMovingAverage), indicator);\r\n\r\nto\r\n\r\n    MovingAverageTypeExtensionsTests.cs\r\n\r\nas suggested https://github.com/QuantConnect/Lean/pull/8177#pullrequestreview-2167076133\r\n\r\n\r\nEdit: hum I'm unsure about that now... VWMA is a MA... but a MA which takes bars as input ... not a simple price. So it should probably be considered differently"}, {"user": "femtotrader", "is_staff": false, "created_at": "2024-07-12T20:48:06Z", "body": "I wonder how I can add VWMA to MovingAverageTypeExtensions.\r\n\r\nThis kind of MA is a bit different from others because it takes a bar as input... not a price.\r\n\r\nAdding \r\n\r\n\r\n                case MovingAverageType.VWMA:\r\n                    return new VolumeWeightedMovingAverage(period);\r\n\r\nto MovingAverageTypeExtensions.cs ... next to others MA\r\n\r\nand I'm getting a compile error\r\n\r\n    Severity\tCode\tDescription\tProject\tFile\tLine\tSuppression State\tDetails\r\n    Error (active)\tCS0029\tCannot implicitly convert type 'QuantConnect.Indicators.VolumeWeightedMovingAverage' to 'QuantConnect.Indicators.IndicatorBase<QuantConnect.Indicators.IndicatorDataPoint>'\tQuantConnect.Indicators\tC:\\Users\\Admin\\git\\github\\femto\\Lean\\Indicators\\MovingAverageTypeExtensions.cs\t76\t\t\r\n  \r\n"}]}