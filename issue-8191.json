{"source": "https://github.com/QuantConnect/Lean", "title": "Penny Pilot Program for Options Pricing", "link": "https://github.com/QuantConnect/Lean/issues/8191", "state": "open", "created_by": "Romazes", "created_at": "2024-07-10T21:22:57Z", "updated_at": "2024-07-23T18:49:18Z", "closed_at": null, "body": "<!--- This template provides sections for bugs and features. Please delete any irrelevant sections before submitting -->\r\n\r\n#### Expected Behavior\r\n<!--- Required. Describe the behavior you expect to see for your case. -->\r\nThe Lean Algorithm should support the Penny Pilot Program, allowing options on eligible securities to be quoted and traded in $0.01 increments for quotes below $3.00 and $0.05 increments for quotes at or above $3.00.\r\n\r\n#### Actual Behavior\r\n<!--- Required. Describe the actual behavior for your case. -->\r\nCurrently, when attempting to update an order on an option such as AAPL with an expiration date of 2024/07/19 and a strike price of 215 (Right: Call), the system throws an error indicating that the price is not rounded to a valid increment. For example, attempting to place an order at a price of 18.12 results in an error like \"18.12000000 not rounded to a valid price increment [0.05]\".\r\n\r\n#### Potential Solution\r\n<!--- Optional. Describe any potential solutions and/or thoughts as to what may be causing the difference between expected and actual behavior. -->\r\n1. **Identify Eligible Securities**: Update the symbol and market data handling to identify securities included in the Penny Pilot Program.\r\n2. **Modify Price Increment Logic**: Adjust the order processing logic to allow $0.01 increments for options priced below $3.00 and maintain $0.05 increments for options priced at or above $3.00.\r\n3. **Validation Updates**: Ensure the order validation process supports the new price increment rules for eligible options.\r\n4. **Testing and Verification**: Implement unit and integration tests to ensure that options eligible under the Penny Pilot Program are correctly handled and that price increments are properly validated.\r\n\r\n#### Reproducing the Problem\r\n<!--- Required for Bugs. Describe how to reproduce the problem. This can be via a failing unit test or a simplified algorithm that reliably demonstrates this issue.  -->\r\n1. Create a new algorithm in the Lean.\r\n2. Use the following code to define an option contract:\r\n```\r\nvar AAPLOption = Symbol.CreateOption(Symbols.AAPL, Market.USA, OptionStyle.American, OptionRight.Call, 215m, new DateTime(2024, 7, 19));\r\n```\r\n3. Attempt to update an order for the AAPL option with a price increment of $0.01, such as 18.12\r\n4. Observe the error indicating that the price is not rounded to a valid increment:\r\n```\r\n18.12000000 not rounded to a valid price increment [0.05]\r\n```\r\nPlease ensure that the Lean Algorithm Framework is updated to handle the Penny Pilot Program pricing increments correctly.\r\n\r\n#### System Information\r\n<!--- Required for Bugs. Include any system specific information, such as OS. -->\r\nOS: Windows 10 x64\r\ntest: run on x64 CPU\r\nIDE: Visual Studio 2022\r\n\r\n#### Additional Sources\r\n- [Cboe - Equity Options Product Specification](https://www.cboe.com/exchange_traded_stock/equity_options_spec/)\r\n- [Reddit - description](https://www.reddit.com/r/options/comments/12bnabs/options_contracts_increments_by_5_cents/)\r\n\r\n#### Checklist\r\n<!--- Confirm that you've provided all the required information. -->\r\n<!--- Required fields --->\r\n- [x] I have completely filled out this template\r\n- [x] I have confirmed that this issue exists on the current `master` branch\r\n- [x] I have confirmed that this is not a duplicate issue by searching [issues](https://github.com/QuantConnect/Lean/issues)\r\n<!--- Required for Bugs, feature request can delete the line below. -->\r\n- [x] I have provided detailed steps to reproduce the issue\r\n\r\n<!--- Template inspired by https://github.com/stevemao/github-issue-templates -->", "comments": [{"user": "Martin-Molinero", "is_staff": true, "created_at": "2024-07-23T18:49:17Z", "body": "IB does not enforce this behavior, TradeStation does, so we have `IndexOptionSymbolProperties` which is dynamic based on price, we feed prices in, maybe we could have `OptionSymbolProperties.PennyProgramEnabled { set; }` which TS brokerage model set to true, we update it with market price and it dynamically changes the options SPDB kind of like the index one, just that enabled only for TS"}]}