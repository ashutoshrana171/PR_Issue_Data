{"source": "https://github.com/QuantConnect/Lean", "title": "ResetsProperly test in Tests.Indicators.TestHelp.cs is looking for trade bar with an indicator of type IndicatorBase<IndicatorDataPoint>", "link": "https://github.com/QuantConnect/Lean/issues/8200", "state": "closed", "created_by": "femtotrader", "created_at": "2024-07-14T13:17:44Z", "updated_at": "2024-07-19T12:26:41Z", "closed_at": "2024-07-19T12:26:41Z", "body": "<!--- This template provides sections for bugs and features. Please delete any irrelevant sections before submitting -->\r\n\r\n#### Expected Behavior\r\n<!--- Required. Describe the behavior you expect to see for your case. -->\r\n\r\nWhen ResetsProperly test is run with an indicator of type `IndicatorBase<IndicatorDataPoint>` it should only look at Close price.\r\nIt shouldn't look for bar ie (open high low close) prices.\r\n\r\nThis lead to test failing for a bad reason as exposed at https://github.com/QuantConnect/Lean/pull/8163#issuecomment-2211718413\r\n\r\n#### Actual Behavior\r\n<!--- Required. Describe the actual behavior for your case. -->\r\n\r\nThis code is problematic\r\n\r\nhttps://github.com/QuantConnect/Lean/blob/9b3400e9d14b12992f454fd7b9ad71414eb6248f/Tests/Indicators/TestHelper.cs#L267-L281\r\n\r\nespecially\r\n\r\nhttps://github.com/QuantConnect/Lean/blob/9b3400e9d14b12992f454fd7b9ad71414eb6248f/Tests/Indicators/TestHelper.cs#L271-L274\r\n\r\n\r\n#### Potential Solution\r\n<!--- Optional. Describe any potential solutions and/or thoughts as to what may be causing the difference between expected and actual behavior. -->\r\n\r\nLook only at Close price.\r\n\r\nSomething like\r\n\r\n```csharp\r\nforeach (var parts in GetCsvFileStream(externalDataFilename))\r\n{\r\n    if (!(parts.ContainsKey(\"Close\")))\r\n    {\r\n        Assert.Fail(\"Didn't find column 'Close'\");\r\n        break;\r\n    }\r\n    indicator.Update(date, parts.GetCsvValue(\"close\").ToDecimal());\r\n}\r\n```\r\n\r\nshould fix that\r\n\r\n#### Reproducing the Problem\r\n<!--- Required for Bugs. Describe how to reproduce the problem. This can be via a failing unit test or a simplified algorithm that reliably demonstrates this issue.  -->\r\n\r\n#### System Information\r\n<!--- Required for Bugs. Include any system specific information, such as OS. -->\r\n\r\n#### Checklist\r\n<!--- Confirm that you've provided all the required information. -->\r\n<!--- Required fields --->\r\n- [x] I have completely filled out this template\r\n- [x] I have confirmed that this issue exists on the current `master` branch\r\n- [x] I have confirmed that this is not a duplicate issue by searching [issues](https://github.com/QuantConnect/Lean/issues)\r\n<!--- Required for Bugs, feature request can delete the line below. -->\r\n- [x] I have provided detailed steps to reproduce the issue\r\n\r\n<!--- Template inspired by https://github.com/stevemao/github-issue-templates -->", "comments": []}